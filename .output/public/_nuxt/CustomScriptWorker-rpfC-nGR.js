self.onmessage=function(c){const{type:s,code:a,self:n,opponent:l}=c.data;if(s==="compile")try{const e=`
        ${a}
        return typeof decide === 'function' ? decide : null;
      `,t=new Function(e)();if(!t){self.postMessage({type:"compiled",success:!1,error:'No "decide" function found. Make sure you define: function decide(self, opponent) { ... }'});return}self._decideFn=t,self.postMessage({type:"compiled",success:!0})}catch(e){self.postMessage({type:"compiled",success:!1,error:`Syntax Error: ${e.message}`})}if(s==="execute"){if(!self._decideFn){self.postMessage({type:"result",success:!1,error:"No script compiled",action:{left:!1,right:!1,up:!1,down:!1,action1:!1,action2:!1,action3:!1}});return}try{const e=self._decideFn(n,l),o={left:!!e?.left,right:!!e?.right,up:!!e?.up,down:!!e?.down,action1:!!e?.action1,action2:!!e?.action2,action3:!!e?.action3};self.postMessage({type:"result",success:!0,action:o})}catch(e){self.postMessage({type:"result",success:!1,error:e.message,action:{left:!1,right:!1,up:!1,down:!1,action1:!1,action2:!1,action3:!1}})}}};
